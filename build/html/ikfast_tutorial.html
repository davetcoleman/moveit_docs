

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IKFast Plugin &mdash; MoveIt! Motion Planning Framework Indigo documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/override.css" type="text/css" />
  

  
    <link rel="top" title="MoveIt! Motion Planning Framework Indigo documentation" href="index.html"/>
        <link rel="next" title="Planning Scene/C++ API" href="planning_scene_tutorial.html"/>
        <link rel="prev" title="Kinematics/C++ API" href="kinematics_tutorial.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home">
        

          MoveIt! Motion Planning Framework

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="move_group_interface_tutorial.html">Move Group Interface/C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="move_group_interface_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_interface_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_interface_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_interface_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_interface_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="move_group_python_interface_tutorial.html">Move Group Interface/Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="move_group_python_interface_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_python_interface_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="move_group_python_interface_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="moveit_setup_assistant_tutorial.html">Setup Assistant Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-1-start">STEP 1: Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-2-generate-self-collision-matrix">STEP 2: Generate Self-Collision Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-3-add-virtual-joints">STEP 3: Add Virtual Joints</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-4-add-planning-groups">STEP 4: Add Planning Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-5-add-robot-poses">STEP 5: Add Robot Poses</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-6-label-end-effectors">STEP 6: Label End Effectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-7-add-passive-joints">STEP 7: Add Passive Joints</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#step-8-generate-configuration-files">STEP 8: Generate Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#what-s-next">What&#8217;s Next</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_setup_assistant_tutorial.html#additional-reading">Additional Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization_tutorial.html">MoveIt! RViz Plugin Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#step-1-launch-the-demo-and-configure-the-plugin">STEP 1: Launch the demo and Configure the Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#step-2-play-with-the-visualized-robots">STEP 2: Play with the visualized robots</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#step-3-interact-with-the-pr2">STEP 3: Interact with the PR2</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#moving-into-collision">Moving into collision</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#moving-out-of-reachable-workspace">Moving out of reachable workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#step-4-use-motion-planning-with-the-pr2">STEP 4: Use Motion Planning with the PR2</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_tutorial.html#what-s-next">What&#8217;s Next</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kinematics_tutorial.html">Kinematics/C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kinematics_tutorial.html#the-robotmodel-and-robotstate-classes">The RobotModel and RobotState classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#expected-output">Expected Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_tutorial.html#additional-reading">Additional Reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">IKFast Plugin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-ikfast">What is IKFast?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moveit-ikfast">MoveIt! IKFast</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moveit-ikfast-installation">MoveIt! IKFast Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#openrave-installation">OpenRAVE Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-collada-file-for-use-with-openrave">Create Collada File For Use With OpenRave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-ikfast-solution-cpp-file">Create IKFast Solution CPP File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#select-ik-type">Select IK Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#choose-planning-group">Choose Planning Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#identify-link-numbers">Identify Link Numbers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generate-ik-solver">Generate IK Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-plugin">Create Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-the-plugin">Test the Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-plugin">Updating the Plugin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="planning_scene_tutorial.html">Planning Scene/C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="planning_scene_ros_api_tutorial.html">Planning Scene/ROS API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_ros_api_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_ros_api_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_ros_api_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_ros_api_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_scene_ros_api_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="motion_planning_api_tutorial.html">Motion Planners/C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="motion_planning_api_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="motion_planning_api_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="motion_planning_api_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="motion_planning_api_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="motion_planning_api_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="planning_pipeline_tutorial.html">Motion Planners/C++ API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="planning_pipeline_tutorial.html#the-entire-code">The entire code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_pipeline_tutorial.html#compiling-the-code">Compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_pipeline_tutorial.html#the-launch-file">The launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_pipeline_tutorial.html#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="planning_pipeline_tutorial.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="moveit_fake_controller_manager_tutorial.html">Controller Manager Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="kinematics_configuration.html">Kinematics/Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kinematics_configuration.html#the-kinematics-yaml-file">The kinematics.yaml file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kinematics_configuration.html#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_configuration.html#the-kdl-kinematics-plugin">The KDL Kinematics Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_configuration.html#the-lma-kinematics-plugin">The LMA Kinematics Plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kinematics_configuration.html#position-only-ik">Position Only IK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="perception_configuration.html">3D Perception/Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="perception_configuration.html#yaml-configuration-file-point-cloud">YAML Configuration file (Point Cloud)</a></li>
<li class="toctree-l2"><a class="reference internal" href="perception_configuration.html#yaml-configuration-file-depth-map">YAML Configuration file (Depth Map)</a></li>
<li class="toctree-l2"><a class="reference internal" href="perception_configuration.html#update-the-launch-file">Update the launch file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="perception_configuration.html#add-the-yaml-file-to-the-launch-script">Add the YAML file to the launch script</a></li>
<li class="toctree-l3"><a class="reference internal" href="perception_configuration.html#octomap-configuration">Octomap Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="controller_configuration.html">Controllers/Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="controller_configuration.html#yaml-configuration">YAML Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller_configuration.html#followjointtrajectory-controller-interface">FollowJointTrajectory Controller Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller_configuration.html#grippercommand-controller-interface">GripperCommand Controller Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller_configuration.html#create-the-controller-launch-file">Create the Controller launch file</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller_configuration.html#debugging-information">Debugging Information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ompl_interface_tutorial.html">OMPL Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ompl_interface_tutorial.html#ompl-optimization-objective-tutorial">OMPL Optimization Objective Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ompl_interface_tutorial.html#source-install-for-ompl-within-catkin-workspace">Source Install For OMPL Within Catkin Workspace</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">MoveIt! Motion Planning Framework</a>
      </nav>

      
      <div class="wy-nav-content">

        <div class="header-override">
          <p>
            <a href="http://moveit.ros.org/">MoveIt! Website</a><br/>
            <a href="http://moveit.ros.org/blog">Blog</a>
          </p>
          <a href="http://moveit.ros.org"><img src="_static/logo.png"></a>
        </div>

        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>IKFast Plugin</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/davetcoleman/moveit_docs/blob/master/source/ikfast_tutorial.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ikfast-plugin">
<h1>IKFast Plugin<a class="headerlink" href="#ikfast-plugin" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will walk through configuring an IKFast plugin for MoveIt!</p>
<div class="section" id="what-is-ikfast">
<h2>What is IKFast?<a class="headerlink" href="#what-is-ikfast" title="Permalink to this headline">¶</a></h2>
<p><em>From Wikipedia:</em>
IKFast, the Robot Kinematics Compiler, is a powerful inverse kinematics solver provided within Rosen Diankov&#8217;s OpenRAVE motion planning software. Unlike most inverse kinematics solvers, IKFast can analytically solve the kinematics equations of any complex kinematics chain, and generate language-specific files (like C++) for later use. The end result is extremely stable solutions that can run as fast as 5 microseconds on recent processors</p>
</div>
<div class="section" id="moveit-ikfast">
<h2>MoveIt! IKFast<a class="headerlink" href="#moveit-ikfast" title="Permalink to this headline">¶</a></h2>
<p>MoveIt! IKFast is a tool that generates a IKFast kinematics plugin for MoveIt using OpenRave generated cpp files.
This tutorial will step you through setting up your robot to utilize the power of IKFast. MoveIt! IKFast is tested on ROS Groovy with Catkin using OpenRave 0.8 with a 6dof and 7dof robot arm manipulator.
While it works in theory, currently the IKFast plugin generator tool does not work with &gt;7 degree of freedom arms.</p>
</div>
<div class="section" id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h2>
<p>You should have already created a MoveIt! configuration package for your robot, by using the Setup Assistant.</p>
</div>
<div class="section" id="moveit-ikfast-installation">
<h2>MoveIt! IKFast Installation<a class="headerlink" href="#moveit-ikfast-installation" title="Permalink to this headline">¶</a></h2>
<p>Install the MoveIt! IKFast package either from debs or from source.</p>
<p><strong>Binary Install</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">ros</span><span class="o">-</span><span class="n">indigo</span><span class="o">-</span><span class="n">moveit</span><span class="o">-</span><span class="n">ikfast</span>
</pre></div>
</div>
<p><strong>Source</strong></p>
<p>Inside your catkin workspace</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ros</span><span class="o">-</span><span class="n">planning</span><span class="o">/</span><span class="n">moveit_ikfast</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="section" id="openrave-installation">
<h2>OpenRAVE Installation<a class="headerlink" href="#openrave-installation" title="Permalink to this headline">¶</a></h2>
<p>OpenRave is available for Ubuntu using these commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">add</span><span class="o">-</span><span class="n">apt</span><span class="o">-</span><span class="n">repository</span> <span class="n">ppa</span><span class="p">:</span><span class="n">openrave</span><span class="o">/</span><span class="n">release</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">openrave0</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="n">dp</span><span class="o">-</span><span class="n">ikfast</span>
</pre></div>
</div>
<p>More detailed and updated instructions are available at <a class="reference external" href="http://openrave.org/docs/latest_stable/install/#install">OpenRave.org</a>.</p>
<p><strong>Note:</strong> You may need to use this hack reported by MoveIt! users:</p>
<p>Edit /usr/lib/python2.7/dist-packages/openravepy/__init__.py to add the following line just after the copyright:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">__openravepy_version__</span> <span class="o">=</span> <span class="s2">&quot;0.8&quot;</span>
</pre></div>
</div>
<p><strong>Note:</strong> Use &#8216;&#8217;openrave0.8&#8217;&#8217; instead of &#8216;&#8217;openrave&#8217;&#8217; in the following tutorial if installed from packages</p>
<p><em>Please report your results with this on the moveit-users mailing list.</em></p>
</div>
<div class="section" id="create-collada-file-for-use-with-openrave">
<h2>Create Collada File For Use With OpenRave<a class="headerlink" href="#create-collada-file-for-use-with-openrave" title="Permalink to this headline">¶</a></h2>
<p>First you will need robot description file that is in <a class="reference external" href="http://openrave.org/docs/latest_stable/collada_robot_extensions/">Collada or OpenRave</a> robot format.</p>
<p>If your robot is not in this format we recommend you create a ROS <a class="reference external" href="http://www.ros.org/wiki/urdf/Tutorials/Create%20your%20own%20urdf%20file">URDF</a> file, then convert it to a Collada .dae file using the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">collada_urdf</span> <span class="n">urdf_to_collada</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">urdf</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">dae</span>
</pre></div>
</div>
<p>where &lt;myrobot_name&gt; is the name of your robot.</p>
<p>Often floating point issues arrise in converting a URDF file to Collada file, so a script has been created to round all the numbers down to x decimal places in your .dae file. Its probably best if you skip this step initially and see if IKFast can generate a solution with your default values, but if the generator takes longer than, say, an hour, try the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">moveit_ikfast</span> <span class="n">round_collada_numbers</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">input_dae</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output_dae</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">decimal</span> <span class="n">places</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>From experience we recommend 5 decimal places, but if the OpenRave ikfast generator takes to long to find a solution, lowering the number of decimal places should help. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">moveit_ikfast</span> <span class="n">round_collada_numbers</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">dae</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">rounded</span><span class="o">.</span><span class="n">dae</span> <span class="mi">5</span>
</pre></div>
</div>
<p>To see the links in your newly generated Collada file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">openrave</span><span class="o">-</span><span class="n">robot</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">dae</span> <span class="o">--</span><span class="n">info</span> <span class="n">links</span>
</pre></div>
</div>
<p>This is useful if you have a 7-dof arm and you need to fill in a &#8211;freeindex parameter, discussed later.</p>
<p>To test your newly generated Collada file in OpenRave:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">openrave</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">dae</span>
</pre></div>
</div>
<div class="section" id="create-ikfast-solution-cpp-file">
<h3>Create IKFast Solution CPP File<a class="headerlink" href="#create-ikfast-solution-cpp-file" title="Permalink to this headline">¶</a></h3>
<p>Once you have a numerically rounded Collada file its time to generate the C++ .h header file that contains the analytical IK solution for your robot.</p>
</div>
</div>
<div class="section" id="select-ik-type">
<h2>Select IK Type<a class="headerlink" href="#select-ik-type" title="Permalink to this headline">¶</a></h2>
<p>You need to choose which sort of IK you want. See <a class="reference external" href="http://openrave.org/docs/latest_stable/openravepy/ikfast/#ik-types">this page</a> for more info.  The most common IK type is <em>transform6d</em>.</p>
</div>
<div class="section" id="choose-planning-group">
<h2>Choose Planning Group<a class="headerlink" href="#choose-planning-group" title="Permalink to this headline">¶</a></h2>
<p>If your robot has more than one arm or &#8220;planning group&#8221; that you want to generate an IKFast solution for, choose one to generate first. The following instructions will assume you have chosen one &lt;planning_group_name&gt; that you will create a plugin for. Once you have verified that the plugin works, repeat the following instructions for any other planning groups you have. For example, you might have 2 planning groups:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">planning_group_name</span><span class="o">&gt;</span> <span class="o">=</span> <span class="s2">&quot;left_arm&quot;</span>
<span class="o">&lt;</span><span class="n">planning_group_name</span><span class="o">&gt;</span> <span class="o">=</span> <span class="s2">&quot;right_arm&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="identify-link-numbers">
<h2>Identify Link Numbers<a class="headerlink" href="#identify-link-numbers" title="Permalink to this headline">¶</a></h2>
<p>You also need the link index numbers for the <em>base_link</em> and <em>end_link</em> between which the IK will be calculated. You can count the number of links by viewing a list of links in your model:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">openrave</span><span class="o">-</span><span class="n">robot</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;.</span><span class="n">dae</span> <span class="o">--</span><span class="n">info</span> <span class="n">links</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: use &#8216;&#8217;openrave0.8-robot.py&#8217;&#8217; if installed from packages</p>
<p>A typical 6-DOF manipulator should have 6 arm links + a dummy base_link as required by ROS specifications.  If no extra links are present in the model, this gives: <em>baselink=0</em> and <em>eelink=6</em>.  Often, an additional tool_link will be provided to position the grasp/tool frame, giving <em>eelink=7</em>.</p>
<p>The manipulator below also has another dummy mounting_link, giving <em>baselink=1</em> and <em>eelink=8</em>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="19%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">index</th>
<th class="head">parents</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>base_link</td>
<td>0</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>mounting_link</td>
<td>1</td>
<td>base_link</td>
</tr>
<tr class="row-even"><td>link1_rotate</td>
<td>2</td>
<td>mounting_link</td>
</tr>
<tr class="row-odd"><td>link2</td>
<td>3</td>
<td>link1_rotate</td>
</tr>
<tr class="row-even"><td>link3</td>
<td>4</td>
<td>link2</td>
</tr>
<tr class="row-odd"><td>link4</td>
<td>5</td>
<td>link3</td>
</tr>
<tr class="row-even"><td>link5</td>
<td>6</td>
<td>link4</td>
</tr>
<tr class="row-odd"><td>link6_wrist</td>
<td>7</td>
<td>link5</td>
</tr>
<tr class="row-even"><td>tool_link</td>
<td>8</td>
<td>link6_wrist</td>
</tr>
</tbody>
</table>
<div class="section" id="generate-ik-solver">
<h3>Generate IK Solver<a class="headerlink" href="#generate-ik-solver" title="Permalink to this headline">¶</a></h3>
<p>To generate the IK solution between the manipulator&#8217;s base and tool frames for a 6 dof arm, use the following command format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>python `openrave-config --python-dir`/openravepy/_openravepy_/ikfast.py --robot=&lt;myrobot_name&gt;.dae --iktype=transform6d --baselink=1 --eelink=8 --savefile=&lt;ikfast_output_path&gt;
</pre></div>
</div>
<p>where &lt;ikfast_output_path&gt; is recommended to be a path that points to a file named ikfast61_&lt;planning_group_name&gt;.cpp.</p>
<p>For a 7 dof arm, you will need to specify a free link:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>python `openrave-config --python-dir`/openravepy/_openravepy_/ikfast.py --robot=&lt;myrobot_name&gt;.dae --iktype=transform6d --baselink=1 --eelink=8 --freeindex=4 --savefile=&lt;ikfast_output_path&gt;
</pre></div>
</div>
<p>The speed and success of this process will depend on the complexity of your robot. A typical 6 DOF manipulator with 3 intersecting axis at the base or wrist will take only a few minutes to generate the IK.</p>
<p>You should consult the OpenRAVE mailing list and ROS Answers for information about 5 and 7 DOF manipulators.</p>
</div>
<div class="section" id="create-plugin">
<h3>Create Plugin<a class="headerlink" href="#create-plugin" title="Permalink to this headline">¶</a></h3>
<p>Create the package that will contain the IK plugin. We recommend you name the package &lt;myrobot_name&gt;_ikfast_&lt;planning_group_name&gt;_plugin. From here on out we&#8217;ll refer to your IKFast package as simply &lt;moveit_ik_plugin_pkg&gt;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">catkin_ws</span><span class="o">/</span><span class="n">src</span>
<span class="n">catkin_create_pkg</span> <span class="o">&lt;</span><span class="n">moveit_ik_plugin_pkg</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Build your workspace so the new package is detected (can be &#8216;roscd&#8217;):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">catkin_ws</span>
<span class="n">catkin_make</span>
</pre></div>
</div>
<p>Create the plugin source code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">moveit_ikfast</span> <span class="n">create_ikfast_moveit_plugin</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">planning_group_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">moveit_ik_plugin_pkg</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">ikfast_output_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Or without ROS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">create_ikfast_moveit_plugin</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">planning_group_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">moveit_ik_plugin_pkg</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">ikfast_output_path</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><em>myrobot_name</em> - name of robot as in your URDF</li>
<li><em>planning_group_name</em> - name of the planning group you would like to use this solver for, as referenced in your SRDF and kinematics.yaml</li>
<li><em>moveit_ik_plugin_pkg</em> - name of the new package you just created</li>
<li><em>ikfast_output_path</em> - file path to the location of your generated IKFast output.cpp file</li>
</ul>
</div></blockquote>
<p>This will generate a new source file &lt;myrobot_name&gt;_&lt;planning_group_name&gt;_ikfast_moveit_plugin.cpp in the src/ directory, and modify various configuration files.</p>
<p>Build your workspace again to create the ik plugin:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">catkin_ws</span>
<span class="n">catkin_make</span>
</pre></div>
</div>
<p>This will build the new plugin library lib/lib&lt;myrobot_name&gt;_&lt;planning_group_name&gt;_moveit_ikfast_moveit_plugin.so that can be used with MoveIt!</p>
</div>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>The IKFast plugin should function identically to the default KDL IK Solver, but with greatly increased performance. The MoveIt configuration file is automatically edited by the moveit_ikfast script but you can switch between the KDL and IKFast solvers using the <em>kinematics_solver</em> parameter in the robot&#8217;s kinematics.yaml file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rosed</span> <span class="o">&lt;</span><span class="n">myrobot_name</span><span class="o">&gt;</span><span class="n">_moveit_config</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">kinematics</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>Edit these parts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">planning_group_name</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="n">kinematics_solver</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">moveit_ik_plugin_pkg</span><span class="o">&gt;/</span><span class="n">IKFastKinematicsPlugin</span>
<span class="o">-</span><span class="n">OR</span><span class="o">-</span>
  <span class="n">kinematics_solver</span><span class="p">:</span> <span class="n">kdl_kinematics_plugin</span><span class="o">/</span><span class="n">KDLKinematicsPlugin</span>
</pre></div>
</div>
</div>
<div class="section" id="test-the-plugin">
<h3>Test the Plugin<a class="headerlink" href="#test-the-plugin" title="Permalink to this headline">¶</a></h3>
<p>Use the MoveIt Rviz Motion Planning Plugin and use the interactive markers to see if correct IK Solutions are found.</p>
</div>
<div class="section" id="updating-the-plugin">
<h3>Updating the Plugin<a class="headerlink" href="#updating-the-plugin" title="Permalink to this headline">¶</a></h3>
<p>If any future changes occur with MoveIt! or IKFast, you might need to re-generate this plugin using our scripts. To allow you to easily do this, a bash script is automatically created in the root of your IKFast package, named <em>update_ikfast_plugin.sh</em>. This does the same thing you did manually earlier, but uses the IKFast solution header file that is copied into the ROS package.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="planning_scene_tutorial.html" class="btn btn-neutral float-right" title="Planning Scene/C++ API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="kinematics_tutorial.html" class="btn btn-neutral" title="Kinematics/C++ API" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'Indigo',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>